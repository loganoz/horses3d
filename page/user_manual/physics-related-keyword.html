<!-- -*- mode: jinja2 -*- -->

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta name="description" content="Documentation for HORSES3D">
    <meta name="author" content="HORSES3D developers" >
    <link rel="icon" href="../../favicon.png">

    <title>Physics related keywords &ndash; HORSES3D</title>

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <!-- Font Awesome -->
    <link href="../../css/fontawesome.min.css" rel="stylesheet">
    <link href="../../css/brands.min.css" rel="stylesheet">
    <link href="../../css/regular.min.css" rel="stylesheet">
    <link href="../../css/solid.min.css" rel="stylesheet">
    <link href="../../css/v4-font-face.min.css" rel="stylesheet">
    <link href="../../css/v4-shims.min.css" rel="stylesheet">
    <!-- MathJax -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { equationNumbers: { autoNumber: "AMS" } }
      });
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML" async
            integrity="sha256-DViIOMYdwlM/axqoGDPeUyf0urLoHMN4QACBKyB58Uw=" crossorigin="anonymous"></script>
    <!-- Other scripts and stylesheets -->
    <link href="../../css/local.css" rel="stylesheet">
    <link href="../../css/pygments.css" rel="stylesheet">
    <script src="../../js/svg-pan-zoom.min.js"></script>
  </head>

  <body>

    <!-- Fixed navbar -->
    <div class="container-fluid mb-sm-4 mb-xl-2">
      <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
        <div class="container">
          <a class="navbar-brand" href="../../index.html">HORSES3D </a>
          <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar"
                  aria-expanded="false" aria-controls="navbar" aria-label="Toggle navigation">
                  <span class="navbar-toggler-icon">
          </button>

          <div id="navbar" class="navbar-collapse collapse">
            <ul class="navbar-nav">
                <li class="nav-item"><a class="nav-link" href="../index.html">Documentation</a></li>
                  <li class="nav-item">
                    <a class="nav-link" href="../../lists/files.html">Source Files</a>
                  </li>
                <li class="nav-item">
                  <a class="nav-link" href="../../lists/modules.html">Modules</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../../lists/procedures.html">Procedures</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../../lists/types.html">Derived Types</a>
                </li>
            </ul>
              <div class="d-flex align-items-end flex-grow-1">
                <form action="../../search.html" role="search" class="ms-auto">
                  <input type="text" class="form-control" aria-label="Search" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
                </form>
              </div>
          </div><!--/.nav-collapse -->
        </div>
      </nav>
    </div>

    <div class="container">
  <div class="row">
    <h1>Physics related keywords</h1>
    <div class="container p-2 mb-4 bg-light border rounded-3">
      <div class="row align-items-center justify-content-between">
        <div class="col">
          <ul class="list-inline" style="margin-bottom:0px; display:inline">
          </ul>
        </div>
        <div class="col">
          <nav aria-label="breadcrumb">
            <ol class="breadcrumb justify-content-end mb-0">
                <li class="breadcrumb-item"><a href='../index.html'>Documentation</a></li>
                <li class="breadcrumb-item"><a href='index.html'>User Manual</a></li>
              <li class="breadcrumb-item active" aria-current="page">Physics related keywords</li>
            </ol>
          </nav>
        </div>
      </div>
    </div>
  </div>

  <div class="row">
      <div class="col-3">
        <div class="card card-body bg-light" id="sidebar-toc">
          <ul class="nav flex-column align-items">
            <li class="nav-item">
              <a class="nav-link" href="../index.html">Documentation</a>
            </li>
          </ul>
          <hr>
          <nav class="nav nav-pills flex-column">
              <a class="nav-link" href="index.html">User Manual</a>
                <nav class="nav nav-pills flex-column">
                                <a class="nav-link" href="input-and-output-files.html">Input and Output Files</a>
              <a class="nav-link" href="running-a-simulation.html">Running a Simulation</a>
              <a class="nav-link" href="spatial-discretization.html">Spatial Discretization</a>
              <a class="nav-link active disabled" href="physics-related-keyword.html">Physics related keywords</a>
              <a class="nav-link" href="implicit-solvers-with-newton-linearization.html">Implicit Solvers with Newton Linearization</a>
              <a class="nav-link" href="explicit-solvers.html">Explicit Solvers</a>
              <a class="nav-link" href="a-nonlinear-p-multigrid-FAS.html">Nonlinear p-Multigrid solver (FAS)</a>
              <a class="nav-link" href="a-p-adaptation-methods.html">p-adaptation-methods</a>
              <a class="nav-link" href="b-immersed-boundary-method.html">Immersed Boundary Method</a>
              <a class="nav-link" href="monitors.html">Monitors</a>
              <a class="nav-link" href="s-advanced-user-setup.html">Advanced User Setup</a>
              <a class="nav-link" href="s-postprocessing.html">Postprocessing</a>
              <a class="nav-link" href="t-appendix.html">Appendix</a>

                </nav>
          </nav>
        </div>
      </div>

    <div class="col-9" id='text'>
      <div class="toc">
<ul>
<li><a href="#compressible-flow">Compressible flow</a><ul>
<li><a href="#shock-capturing">Shock capturing</a><ul>
<li><a href="#spectral-vanishing-viscosity">Spectral vanishing viscosity</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<h2 id="compressible-flow">Compressible flow</h2>
<table class="table table-striped">
<thead>
<tr>
<th>Keyword</th>
<th>Description</th>
<th>Default value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Mach number</td>
<td><em>REAL</em>:</td>
<td>Mandatory keyword</td>
</tr>
<tr>
<td>Reynolds number</td>
<td><em>REAL</em>:</td>
<td>Mandatory keyword</td>
</tr>
<tr>
<td>Prandtl number</td>
<td><em>REAL</em>:</td>
<td>0.72</td>
</tr>
<tr>
<td>Turbulent Prandtl number</td>
<td><em>REAL</em>:</td>
<td>Equal to Prandtl</td>
</tr>
<tr>
<td>AOA theta</td>
<td><em>REAL</em>: Angle of attack (degrees), based on the spherical coordinates polar angle (<script type="math/tex">\theta</script>) definition</td>
<td>0.0</td>
</tr>
<tr>
<td>AOA phi</td>
<td><em>REAL</em>: Angle of attack (degrees), based on the spherical coordinates azimuthal angle (<script type="math/tex">\varphi</script>) definition</td>
<td>0.0</td>
</tr>
<tr>
<td>LES model</td>
<td><em>CHARACTER</em>(*): Options are: Vreman, Wale, Smagorinsky, None</td>
<td>None</td>
</tr>
<tr>
<td>Wall model</td>
<td><em>CHARACTER</em>:</td>
<td>linear</td>
</tr>
</tbody>
</table>
<h3 id="shock-capturing">Shock capturing</h3>
<p>The shock-capturing module helps stabilize cases with discontinuous solutions, and may also improve the results of under-resolved turbulent cases. It is built on top of a <em>Sensors</em> module that detects problematic flow regions, classifying them according to the value of the sensor, <script type="math/tex"> s </script>, mapped into the interval <script type="math/tex"> a \in [0,1] </script>,</p>
<p>
<script type="math/tex; mode=display">
    a = \left\{\begin{array}{ll}
        0, & \text{if } s \leq s_0 - \Delta s / 2, \\
        \frac{1}{2}\left[1+\sin\left(\frac{s-s_0}{\Delta s}\right)\right], & \text{if } s_0 - \Delta s / 2 < s < s_0 + \Delta s / 2,  \\
        1, & \text{elsewhere}.
    \end{array}\right.
</script>
</p>
<p>The values of <script type="math/tex">s_0 = (s_1 + s_2)/2</script> and<script type="math/tex">\Delta s = s_2 - s_1</script> depend on the sensor thresholds<script type="math/tex">s_1</script> and<script type="math/tex">s_2</script>.</p>
<p>At the moment, flow regions where <script type="math/tex">a \leq 0</script> are considered smooth and no stabilization algorithm can be imposed there. In the central region of the sensor, with <script type="math/tex">0 < a < 1</script>, the methods shown in the next table can be used and even scaled with the sensor value, so that their intensity increases in elements with more instabilities. Finally, the higher part of the sensor range can implement a different method from the table; however, the intensity is set to the maximum this time.</p>
<p>All the methods implemented introduce artificial dissipation into the equations, which can be filtered with an SVV kernel to reduce the negative impact on the accuracy of the solution. Its intensity is controlled with the parameters<script type="math/tex">\mu</script> (similar to the viscosity of the Navier-Stokes equations) and<script type="math/tex">\alpha</script> (scaling of the density-regularization term of the Guermond-Popov flux), which can be set as constants or coupled to the value of the sensor or to a Smagorinsky formulation.</p>
<table class="table table-striped">
<thead>
<tr>
<th>Keyword</th>
<th>Description</th>
<th>Default value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Enable shock-capturing</td>
<td><em>LOGICAL</em>: Switch on/off the shock-capturing stabilization</td>
<td>.FALSE.</td>
</tr>
<tr>
<td>Shock sensor</td>
<td><em>CHARACTER</em>: Type of sensor to be used to detect discontinuous regions Options are: <ul><li>Zeros: always return 0</li><li>Ones: always return 1</li><li>Integral: integral of the sensor variable inside each element</li><li>Integral with sqrt: square root of the Integral sensor</li><li>Modal: based on the relative weight of the higher order modes</li><li>Truncation error: estimate the truncation error of the approximation</li><li>Aliasing error: estimate the aliasing error of the approximation</li><li>GMM: clustering sensor based on the divergence of the velocity and the gradient of the pressure</li></ul></td>
<td>Integral</td>
</tr>
<tr>
<td>Shock first method</td>
<td><em>CHARACTER</em>: Method to be used in the middle region of the sensor (<script type="math/tex">a\in[0,1]</script>). Options are: <ul><li>None: Do not apply any smoothing</li><li>Non-filtered: Apply the selected viscous flux without SVV filtering</li><li>SVV: Apply an entropy-stable, SVV-filtered viscous flux</li></ul></td>
<td>None</td>
</tr>
<tr>
<td>Shock second method</td>
<td><em>CHARACTER</em>: Method to be used in the top-most region of the sensor (<script type="math/tex">a=1</script>). Options are: <ul><li>None: Do not apply any smoothing</li><li>Non-filtered: Apply the selected viscous flux without SVV filtering</li><li>SVV: Apply an entropy-stable, SVV-filtered viscous flux</li></ul></td>
<td>None</td>
</tr>
<tr>
<td>Shock viscous flux 1</td>
<td><em>CHARACTER</em>: Viscous flux to be applied in the elements where<script type="math/tex">a\in[0,1]</script>. Options are: <ul><li>Physical</li><li>Guermond-Popov (only with entropy variables gradients)</li></ul></td>
<td>--</td>
</tr>
<tr>
<td>Shock viscous flux 2</td>
<td><em>CHARACTER</em>: Viscous flux to be applied in the elements where<script type="math/tex">a=1</script>. Options are: <ul><li>Physical</li><li>Guermond-Popov (only with entropy variables gradients)</li></ul></td>
<td>--</td>
</tr>
<tr>
<td>Shock update strategy</td>
<td><em>CHARACTER</em>: Method to compute the variable parameter of the specified shock-capturing approach in the middle region of the sensor. Options are: <ul><li>Constant</li><li>Sensor</li><li>Smagorinsky: only for <em>non-filtered</em> and <em>SVV</em></li></ul></td>
<td>Constant</td>
</tr>
<tr>
<td>Shock mu 1</td>
<td><em>REAL/CHARACTER(</em>)*: Viscosity parameter<script type="math/tex">\mu_1</script>, or<script type="math/tex">C_s</script> in the case of LES coupling</td>
<td>0.0</td>
</tr>
<tr>
<td>Shock alpha 1</td>
<td><em>REAL</em>: Viscosity parameter<script type="math/tex">\alpha_1</script>
</td>
<td>0.0</td>
</tr>
<tr>
<td>Shock mu 2</td>
<td><em>REAL</em>: Viscosity parameter<script type="math/tex">\mu_2</script>
</td>
<td>
<script type="math/tex">\mu_1</script>
</td>
</tr>
<tr>
<td>Shock alpha 2</td>
<td><em>REAL</em>: Viscosity parameter<script type="math/tex">\alpha_2</script>
</td>
<td>
<script type="math/tex">\alpha_1</script>
</td>
</tr>
<tr>
<td>Shock alpha/mu</td>
<td><em>REAL</em>: Ratio between<script type="math/tex">\alpha</script> and <script type="math/tex">\mu</script>. It can be specified instead of <script type="math/tex">\alpha</script> itself to make it dependent on the corresponding values of<script type="math/tex">\mu</script>, and it is compulsory when using LES coupling</td>
<td>--</td>
</tr>
<tr>
<td>SVV filter cutoff</td>
<td><em>REAL/CHARACTER(</em>)*: Cutoff of the filter kernel,<script type="math/tex">P</script>. If "automatic", its value is adjusted automatically</td>
<td>"automatic"</td>
</tr>
<tr>
<td>SVV filter shape</td>
<td><em>CHARACTER(</em>)*: Options are: <ul><li>Power</li><li>Sharp</li><li>Exponential</li></ul></td>
<td>Power</td>
</tr>
<tr>
<td>SVV filter type</td>
<td><em>CHARACTER(</em>)*: Options are: <ul><li>Low-pass</li><li>High-pass</li></ul></td>
<td>High-pass</td>
</tr>
<tr>
<td>Sensor variable</td>
<td><em>CHARACTER(</em>)*: Variable used by the sensor to detect shocks. Options are: <ul><li>rho</li><li>rhou</li><li>rhov</li><li>rhow</li><li>u</li><li>v</li><li>w</li><li>p</li><li>rhop</li><li>grad rho</li><li>div v</li></ul></td>
<td>rhop</td>
</tr>
<tr>
<td>Sensor lower limit</td>
<td><em>REAL</em>: Lower threshold of the central sensor region,<script type="math/tex">s_1</script>
</td>
<td><strong>Mandatory keyword</strong> (except GMM)</td>
</tr>
<tr>
<td>Sensor higher limit</td>
<td><em>REAL</em>: Upper threshold of the central sensor region,<script type="math/tex">s_2</script>
</td>
<td></td>
</tr>
<tr>
<td>Sensor TE min N</td>
<td><em>INTEGER</em>: Minimum polynomial order of the coarse mesh used for the truncation error estimation</td>
<td>1</td>
</tr>
<tr>
<td>Sensor TE delta N</td>
<td>Polynomial order difference between the solution mesh and its coarser representation</td>
<td>1</td>
</tr>
<tr>
<td>Sensor TE derivative</td>
<td><em>CHARACTER</em>: Whether the face terms must be considered in the estimation of the truncation error or not. Options are: <ul><li>Non-isolated</li><li>Isolated</li></ul></td>
<td>Isolated</td>
</tr>
<tr>
<td>Sensor number of clusters</td>
<td><em>INTEGER</em>: Maximum number of clusters to use with the GMM sensor</td>
<td>2</td>
</tr>
<tr>
<td>Sensor min. steps</td>
<td><em>INTEGER</em>: Minimum number of time steps that an element will remain detected. The last positive value will be used if the sensor "undetects" an element too early</td>
<td>1</td>
</tr>
</tbody>
</table>
<h4 id="spectral-vanishing-viscosity">Spectral vanishing viscosity</h4>
<p>The introduction of an SVV-filtered artificial flux helps dissipate high-frequency oscillations. The baseline viscous flux can be chosen as the Navier-Stokes viscous flux or the flux developed by Guermond and Popov. In any case, this flux is expressed in a modal base where it is filtered by any of the following three filter kernels:</p>
<ul>
<li>power: <script type="math/tex">\hat{F}^{\text{1D}}_i = (i/N)^P</script>,</li>
<li>sharp: <script type="math/tex">\hat{F}^{\text{1D}}_i = 0</script> if (i</li>
</ul>
    </div>
  </div>
      <hr>
    </div> <!-- /container -->
    <footer>
      <div class="container">
        <div class="row justify-content-between">
          <div class="col">
            <p>
              HORSES3D
 was developed by HORSES3D developers<br>              &copy; 2026 <a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc/4.0/80x15.png" /></a>
</p>
          </div>
          <div class="col">
            <p class="text-end">
              Documentation generated by
              <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
 on 2026-02-19 08:00 +0000             </p>
          </div>
        </div>
        <br>
      </div> <!-- /container -->
    </footer>
  </body>
</html>