<!-- -*- mode: jinja2 -*- -->

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta name="description" content="Documentation for HORSES3D">
    <meta name="author" content="HORSES3D developers" >
    <link rel="icon" href="../../favicon.png">

    <title>Implicit Solvers with Newton Linearization &ndash; HORSES3D</title>

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <!-- Font Awesome -->
    <link href="../../css/fontawesome.min.css" rel="stylesheet">
    <link href="../../css/brands.min.css" rel="stylesheet">
    <link href="../../css/regular.min.css" rel="stylesheet">
    <link href="../../css/solid.min.css" rel="stylesheet">
    <link href="../../css/v4-font-face.min.css" rel="stylesheet">
    <link href="../../css/v4-shims.min.css" rel="stylesheet">
    <!-- MathJax -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { equationNumbers: { autoNumber: "AMS" } }
      });
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML" async
            integrity="sha256-DViIOMYdwlM/axqoGDPeUyf0urLoHMN4QACBKyB58Uw=" crossorigin="anonymous"></script>
    <!-- Other scripts and stylesheets -->
    <link href="../../css/local.css" rel="stylesheet">
    <link href="../../css/pygments.css" rel="stylesheet">
    <script src="../../js/svg-pan-zoom.min.js"></script>
  </head>

  <body>

    <!-- Fixed navbar -->
    <div class="container-fluid mb-sm-4 mb-xl-2">
      <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
        <div class="container">
          <a class="navbar-brand" href="../../index.html">HORSES3D </a>
          <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar"
                  aria-expanded="false" aria-controls="navbar" aria-label="Toggle navigation">
                  <span class="navbar-toggler-icon">
          </button>

          <div id="navbar" class="navbar-collapse collapse">
            <ul class="navbar-nav">
                <li class="nav-item"><a class="nav-link" href="../index.html">Documentation</a></li>
                  <li class="nav-item">
                    <a class="nav-link" href="../../lists/files.html">Source Files</a>
                  </li>
                <li class="nav-item">
                  <a class="nav-link" href="../../lists/modules.html">Modules</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../../lists/procedures.html">Procedures</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../../lists/types.html">Derived Types</a>
                </li>
            </ul>
              <div class="d-flex align-items-end flex-grow-1">
                <form action="../../search.html" role="search" class="ms-auto">
                  <input type="text" class="form-control" aria-label="Search" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
                </form>
              </div>
          </div><!--/.nav-collapse -->
        </div>
      </nav>
    </div>

    <div class="container">
  <div class="row">
    <h1>Implicit Solvers with Newton Linearization</h1>
    <div class="container p-2 mb-4 bg-light border rounded-3">
      <div class="row align-items-center justify-content-between">
        <div class="col">
          <ul class="list-inline" style="margin-bottom:0px; display:inline">
          </ul>
        </div>
        <div class="col">
          <nav aria-label="breadcrumb">
            <ol class="breadcrumb justify-content-end mb-0">
                <li class="breadcrumb-item"><a href='../index.html'>Documentation</a></li>
                <li class="breadcrumb-item"><a href='index.html'>User Manual</a></li>
              <li class="breadcrumb-item active" aria-current="page">Implicit Solvers with Newton Linearization</li>
            </ol>
          </nav>
        </div>
      </div>
    </div>
  </div>

  <div class="row">
      <div class="col-3">
        <div class="card card-body bg-light" id="sidebar-toc">
          <ul class="nav flex-column align-items">
            <li class="nav-item">
              <a class="nav-link" href="../index.html">Documentation</a>
            </li>
          </ul>
          <hr>
          <nav class="nav nav-pills flex-column">
              <a class="nav-link" href="index.html">User Manual</a>
                <nav class="nav nav-pills flex-column">
                                <a class="nav-link" href="input-and-output-files.html">Input and Output Files</a>
              <a class="nav-link" href="running-a-simulation.html">Running a Simulation</a>
              <a class="nav-link" href="spatial-discretization.html">Spatial Discretization</a>
              <a class="nav-link" href="physics-related-keyword.html">Physics related keywords</a>
              <a class="nav-link active disabled" href="implicit-solvers-with-newton-linearization.html">Implicit Solvers with Newton Linearization</a>
              <a class="nav-link" href="explicit-solvers.html">Explicit Solvers</a>
              <a class="nav-link" href="a-nonlinear-p-multigrid-FAS.html">Nonlinear p-Multigrid solver (FAS)</a>
              <a class="nav-link" href="a-p-adaptation-methods.html">p-adaptation-methods</a>
              <a class="nav-link" href="b-immersed-boundary-method.html">Immersed Boundary Method</a>
              <a class="nav-link" href="monitors.html">Monitors</a>
              <a class="nav-link" href="s-advanced-user-setup.html">Advanced User Setup</a>
              <a class="nav-link" href="s-postprocessing.html">Postprocessing</a>
              <a class="nav-link" href="t-appendix.html">Appendix</a>

                </nav>
          </nav>
        </div>
      </div>

    <div class="col-9" id='text'>
      <div class="toc">
<ul>
<li><a href="#general-keywords">General Keywords</a></li>
<li><a href="#keywords-for-the-bdf-methods">Keywords for the BDF Methods</a></li>
<li><a href="#keywords-for-the-resenbrock-type-implicit-runge-kutta-methods">Keywords for the Resenbrock-Type Implicit Runge-Kutta Methods</a></li>
<li><a href="#jacobian-specifications">Jacobian Specifications</a></li>
</ul>
</div>
<h2 id="general-keywords">General Keywords</h2>
<p>The keywords for the implicit solvers are listed in the table below:</p>
<table class="table table-striped">
<thead>
<tr>
<th>Keyword</th>
<th>Description</th>
<th>Default value</th>
</tr>
</thead>
<tbody>
<tr>
<td>time integration</td>
<td><em>CHARACTER</em>: This is the main keyword for activating the implicit solvers. The value of it should be set to 'implicit' for the BDF solvers and to 'rosenbrock' for Rosenbrock schemes. <br> 'explicit'</td>
<td>'explicit'</td>
</tr>
<tr>
<td>linear solver</td>
<td><em>CHARACTER</em>: Specifies the linear solver that has to be used. Options are:<br> - 'petsc': PETSc library Krylov-Subspace methods. Available in serial, but use with care (PETSc is not thread-safe, so OpenMP is not recommended). Only available in parallel (MPI) for preallocated Jacobians (see next section).<br> - 'pardiso': Intel MKL PARDISO. Only available in serial or with OpenMP.<br> - 'matrix-free gmres': A matrix-free version of the GMRES algorithm. Can be used without preconditioner or with a recursive GMRES preconditioner using 'preconditioner=GMRES'. Available in serial and parallel (OpenMP+MPI)<br> - 'smooth': Traditional iterative methods. One can select either 'smoother=WeightedJacobi' or 'smoother=BlockJacobi'.<br> - 'matrix-free smooth': A matrix-free version of the previous solver. Only available with 'smoother=BlockJacobi'.</td>
<td>'petsc'</td>
</tr>
</tbody>
</table>
<h2 id="keywords-for-the-bdf-methods">Keywords for the BDF Methods</h2>
<p>The BDF methods implemented in <code>HORSES3D</code> use a Newton's method</p>
<table class="table table-striped">
<thead>
<tr>
<th>Keyword</th>
<th>Description</th>
<th>Default value</th>
</tr>
</thead>
<tbody>
<tr>
<td>bdf order</td>
<td><em>INTEGER</em>: If present, the solver uses a BDF solver of the specified order. BDF1 - BDF5 are available, and BDF2 - BDF5 require constant time steps.</td>
<td>1</td>
</tr>
<tr>
<td>jacobian by convergence</td>
<td><em>LOGICAL</em>: When .TRUE., the Jacobian is only computed when the convergence falls beneath a threshold (hard-coded). This improves performance.</td>
<td>.FALSE.</td>
</tr>
<tr>
<td>compute jacobian every</td>
<td><em>INTEGER</em>: Forces the Jacobian to be computed in an interval of iterations that is specified.</td>
<td>Inf</td>
</tr>
<tr>
<td>print newton info</td>
<td><em>LOGICAL</em>: If .TRUE., the information of the Newton iterations will be displayed.</td>
<td>'.FALSE.'</td>
</tr>
<tr>
<td>implicit adaptive dt</td>
<td><em>LOGICAL</em>: Specifies if the time-step should be computed according to the convergence behavior of the Newton iterative method and the linear solver.</td>
<td>.FALSE.</td>
</tr>
<tr>
<td>newton tolerance</td>
<td><em>REAL</em>: Specifies the tolerance for the Newton's method.</td>
<td>
<script type="math/tex">10^{-6}</script> for time-accurate simulations, or <script type="math/tex">MaxResidual \times a</script> for steady-state simulations, where <script type="math/tex">a</script> is the keyword <em>newton factor</em></td>
</tr>
<tr>
<td>newton max iter</td>
<td><em>INTEGER</em>: Maximum number of Newton iterations for BDF solver.</td>
<td>30</td>
</tr>
<tr>
<td>linsolver max iter</td>
<td><em>INTEGER</em>: Maximum number of iterations to be taken by the linear solver. This keyword only affects iterative linear solvers.</td>
<td>500</td>
</tr>
<tr>
<td>newton factor</td>
<td><em>REAL</em>: In simulations that are not time-accurate, the tolerance of the Newton's method is a function of the residual: <script type="math/tex">MaxResidual \times a</script>, where <script type="math/tex">a</script> is the specified value.</td>
<td>
<script type="math/tex">10^{-3}</script>
</td>
</tr>
<tr>
<td>linsolver tol factor</td>
<td><em>REAL</em>: The linear solver tolerance is a function of the absolute error of the Newton's method:  (tol=| e_{\infty}</td>
<td>*a^i), where <script type="math/tex">e</script> is the absolute error of the Newton's method, <script type="math/tex">i</script> is the Newton iteration number, and <script type="math/tex">a</script> is the specified value.</td>
</tr>
<tr>
<td>newton first norm</td>
<td><em>REAL</em>: Specifies an assumed infinity norm of the absolute error of the Newton's method at the iteration <script type="math/tex">0</script> of the time step <script type="math/tex">1</script>. This can change the behavior of the first Newton iterative method because of the dependency of the linear system tolerance on the absolute error of the Newton's method (see keyword <em>linsolver tol factor</em>).</td>
<td>
<script type="math/tex">0.2</script>
</td>
</tr>
</tbody>
</table>
<h2 id="keywords-for-the-resenbrock-type-implicit-runge-kutta-methods">Keywords for the Resenbrock-Type Implicit Runge-Kutta Methods</h2>
<table class="table table-striped">
<thead>
<tr>
<th>Keyword</th>
<th>Description</th>
<th>Default value</th>
</tr>
</thead>
<tbody>
<tr>
<td>rosenbrock scheme</td>
<td><em>CHARACTER</em>: Rosenbrock scheme to be used. Currently, only the <em>RO6-6</em> is implemented.</td>
<td>--</td>
</tr>
</tbody>
</table>
<h2 id="jacobian-specifications">Jacobian Specifications</h2>
<p>The Jacobian must be defined using a block of the form:</p>
<div class="codehilite"><pre><span></span><code><span class="gh">#define Jacobian</span>
   type = 2
   print info = .TRUE.
   preallocate = .TRUE.
<span class="gh">#end</span>
</code></pre></div>

<table class="table table-striped">
<thead>
<tr>
<th>Keyword</th>
<th>Description</th>
<th>Default value</th>
</tr>
</thead>
<tbody>
<tr>
<td>type</td>
<td><em>INTEGER</em>: Specifies the type of Jacobian matrix to be computed. Options are:<br> 1. Numerical Jacobian: Uses a coloring algorithm and a finite difference method to compute the DG Jacobian matrix (only available with shared memory parallelization).<br> 2. Analytical Jacobian: Available with shared (OpenMP) or distributed (MPI) memory parallelization for advective and/or diffusive nonlinear conservation laws, <strong>BUT</strong> only for the standard DGSEM (no split-form).</td>
<td><strong>Mandatory Keyword</strong></td>
</tr>
<tr>
<td>print info</td>
<td><em>LOGICAL</em>: Specifies the verbosity of the Jacobian subroutines</td>
<td>.TRUE.</td>
</tr>
<tr>
<td>preallocate</td>
<td><em>LOGICAL</em>: Specifies if the Jacobian must be allocated in preprocessing (.TRUE. - only available for advective/diffusive nonlinear conservation laws) or every time it is computed (.FALSE.)</td>
<td>.FALSE.</td>
</tr>
</tbody>
</table>
    </div>
  </div>
      <hr>
    </div> <!-- /container -->
    <footer>
      <div class="container">
        <div class="row justify-content-between">
          <div class="col">
            <p>
              HORSES3D
 was developed by HORSES3D developers<br>              &copy; 2025 <a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc/4.0/80x15.png" /></a>
</p>
          </div>
          <div class="col">
            <p class="text-end">
              Documentation generated by
              <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
 on 2025-10-31 10:48 +0000             </p>
          </div>
        </div>
        <br>
      </div> <!-- /container -->
    </footer>
  </body>
</html>