<!-- -*- mode: jinja2 -*- -->

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta name="description" content="Documentation for HORSES3D">
    <meta name="author" content="HORSES3D developers" >
    <link rel="icon" href="../../favicon.png">

    <title>Nonlinear p-Multigrid solver (FAS) &ndash; HORSES3D</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <link href="../../css/pygments.css" rel="stylesheet">
    <link href="../../css/font-awesome.min.css" rel="stylesheet">
    <link href="../../css/local.css" rel="stylesheet">

    <script src="https://code.jquery.com/jquery-3.7.1.min.js" integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>
    <script src="../../js/svg-pan-zoom.min.js"></script>
  </head>

  <body>

    <!-- Fixed navbar -->
    <div class="container-fluid mb-sm-4 mb-xl-2">
      <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
        <div class="container">
          <a class="navbar-brand" href="../../index.html">HORSES3D </a>
          <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar"
                  aria-expanded="false" aria-controls="navbar" aria-label="Toggle navigation">
                  <span class="navbar-toggler-icon">
          </button>

          <div id="navbar" class="navbar-collapse collapse">
            <ul class="navbar-nav">
                <li class="nav-item"><a class="nav-link" href="../index.html">Documentation</a></li>
                  <li class="nav-item">
                    <a class="nav-link" href="../../lists/files.html">Source Files</a>
                  </li>
                <li class="nav-item">
                  <a class="nav-link" href="../../lists/modules.html">Modules</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../../lists/procedures.html">Procedures</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../../lists/absint.html">Abstract Interfaces</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../../lists/types.html">Derived Types</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../../lists/programs.html">Programs</a>
                </li>
            </ul>
          </div><!--/.nav-collapse -->
        </div>
      </nav>
    </div>

    <div class="container">
  <div class="row">
    <h1>Nonlinear p-Multigrid solver (FAS)</h1>
    <div class="container p-2 mb-4 bg-light border rounded-3">
      <div class="row align-items-center justify-content-between">
        <div class="col">
          <ul class="list-inline" style="margin-bottom:0px; display:inline">
          </ul>
        </div>
        <div class="col">
          <nav aria-label="breadcrumb">
            <ol class="breadcrumb justify-content-end mb-0">
                <li class="breadcrumb-item"><a href='../index.html'>Documentation</a></li>
                <li class="breadcrumb-item"><a href='index.html'>User Manual</a></li>
              <li class="breadcrumb-item active" aria-current="page">Nonlinear p-Multigrid solver (FAS)</li>
            </ol>
          </nav>
        </div>
      </div>
    </div>
  </div>

  <div class="row">
      <div class="col-3">
        <div class="card card-body bg-light" id="sidebar-toc">
          <ul class="nav flex-column align-items">
            <li class="nav-item">
              <a class="nav-link" href="../index.html">Documentation</a>
            </li>
          </ul>
          <hr>
          <nav class="nav nav-pills flex-column">
              <a class="nav-link" href="index.html">User Manual</a>
                <nav class="nav nav-pills flex-column">
                                <a class="nav-link" href="input-and-output-files.html">Input and Output Files</a>
              <a class="nav-link" href="running-a-simulation.html">Running a Simulation</a>
              <a class="nav-link" href="spatial-discretization.html">Spatial Discretization</a>
              <a class="nav-link" href="physics-related-keyword.html">Physics related keywords</a>
              <a class="nav-link" href="implicit-solvers-with-newton-linearization.html">Implicit Solvers with Newton Linearization</a>
              <a class="nav-link" href="explicit-solvers.html">Explicit Solvers</a>
              <a class="nav-link active disabled" href="a-nonlinear-p-multigrid-FAS.html">Nonlinear p-Multigrid solver (FAS)</a>
              <a class="nav-link" href="a-p-adaptation-methods.html">p-adaptation-methods</a>
              <a class="nav-link" href="b-immersed-boundary-method.html">Immersed Boundary Method</a>
              <a class="nav-link" href="monitors.html">Monitors</a>
              <a class="nav-link" href="s-advanced-user-setup.html">Advanced User Setup</a>
              <a class="nav-link" href="s-postprocessing.html">Postprocessing</a>
              <a class="nav-link" href="t-appendix.html">Appendix</a>

                </nav>
          </nav>
        </div>
      </div>

    <div class="col-9" id='text'>
      <p>The code has an implementation of the Full Approximation Scheme (FAS) nonlinear <script type="math/tex">p</script>-multigrid method. The main keywords to use it are shown in the table below:</p>
<table class="table table-striped">
<thead>
<tr>
<th>Keyword</th>
<th>Description</th>
<th>Default value</th>
</tr>
</thead>
<tbody>
<tr>
<td>time integration</td>
<td><em>CHARACTER</em>: This is the main keyword to activate the multigrid solvers. The value of it should be set to 'FAS' for the Full Approximation Scheme (FAS) nonlinear multigrid  solvers and to 'AnisFAS' for anisotropic FAS schemes.</td>
<td>'explicit'</td>
</tr>
<tr>
<td>simulation type</td>
<td><em>CHARACTER</em>: Specifies if HORSES3D must perform a ’steady-state’ or a ’time-accurate’. If 'time-accurate' the solver switches to BDF integration (the exact method can be set using 'bdf order' option) and uses FAS as a local steady-state problem solver. Compatible only with 'FAS'.</td>
<td>'steady-state'</td>
</tr>
<tr>
<td>multigrid levels</td>
<td><em>INTEGER</em>: Number of multigrid levels for the computations.</td>
<td><strong>Mandatory keyword</strong></td>
</tr>
<tr>
<td>delta n</td>
<td><em>INTEGER</em>: Interval of reduction of polynomial order for creating coarser multigrid levels.</td>
<td>1</td>
</tr>
<tr>
<td>multigrid output</td>
<td><em>LOGICAL</em>: If .TRUE., the residuals at the different multigrid levels will be displayed.</td>
<td>.FALSE.</td>
</tr>
<tr>
<td>mg sweeps</td>
<td><em>INTEGER</em>: Number of smoothing sweeps to be taken.</td>
<td>1*</td>
</tr>
<tr>
<td>mg sweeps pre</td>
<td><em>INTEGER</em>: Number of pre-smoothing sweeps to be taken.</td>
<td>1*</td>
</tr>
<tr>
<td>mg sweeps post</td>
<td><em>INTEGER</em>: Number of post-smoothing sweeps to be taken.</td>
<td>1*</td>
</tr>
<tr>
<td>mg sweeps coarsest</td>
<td><em>INTEGER</em>: Number of pre- and post-smoothing sweeps to be taken on the coarsest multigrid level.</td>
<td>Average between pre-sweeps and post-sweeps</td>
</tr>
<tr>
<td>mg sweeps exact</td>
<td><em>INTEGER(:)</em>: Alternative to 'mg sweeps'. Defines exact number of pre- and post- smoothing sweeps to be taken on each level. Index of the array indicates the MG level for the sweeps to be performed, e.g. [1,4] performs 1 pre-sweep and 1 post-sweep on level 1 and 4 pre-\/post-sweeps on level 2.</td>
<td>1*</td>
</tr>
<tr>
<td>mg sweeps pre exact</td>
<td><em>INTEGER(:)</em>: Alternative to 'mg sweeps pre'. Defines exact number of pre-smoothing sweeps to be taken on each level. Index of the array indicates the MG level for the sweeps to be performed, e.g. [1,4] performs 1 pre-sweep on level 1 and 4 pre-sweeps on level 2.</td>
<td>1*</td>
</tr>
<tr>
<td>mg sweeps post exact</td>
<td><em>INTEGER(:)</em>: Alternative to 'mg sweeps post'. Defines exact number of post-smoothing sweeps to be taken on each level. Index of the array indicates the MG level for the sweeps to be performed, e.g. [1,4] performs 1 post-sweep on level 1 and 4 post-sweeps on level 2.</td>
<td>1*</td>
</tr>
<tr>
<td>mg smoother</td>
<td><em>CHARACTER</em>: The smoothing technique to be used. The keywords and possible explicit smoothers are the same as the 'explicit method' in the <a href="explicit-solvers.html">explicit solvers</a> section. For the semi-implicit residual relaxation use 'BIRK5'.</td>
<td>RK3</td>
</tr>
<tr>
<td>fasfmg residual</td>
<td><em>REAL</em>: When this keyword is used, the code uses a full multigrid (FMG) method to obtain an initial condition for the simulation. The initial condition has the specified residual.</td>
<td>--</td>
</tr>
<tr>
<td>fasfmg save solutions</td>
<td><em>LOGICAL</em>: Save the solutions that are obtained at the different FMG levels. Only usable when fasfmg residual is used.</td>
<td>.FALSE.</td>
</tr>
<tr>
<td>postsmooth option</td>
<td><em>CHARACTER</em>: When this keyword is used, the code performs extra post-smoothing sweeps, so that the final residual after completing the post-smoothing is lower than the residual achieved by the pre-smoothing. The options are:  - 'f-cycle': Do the extra post-smoothing with an FMG cycle.  - 'smooth': Do normal smoothing.</td>
<td>--</td>
</tr>
<tr>
<td>smooth fine</td>
<td><em>REAL</em>: Extra pre-smoothing is performed on a multigrid level of order <script type="math/tex">P</script>, until a residual is obtained <script type="math/tex">(\|\tilde{R}^{P}\|_{\infty} < \eta \|\tilde{R}^{N}\|_{\infty}) </script>, where <script type="math/tex">N</script> is the polynomial order of the next (coarsest) grid, and <script type="math/tex">\eta</script> is the specified value.</td>
<td>--</td>
</tr>
<tr>
<td>max mg sweeps</td>
<td><em>INTEGER</em>: Maximum number of smoothing sweeps to be performed. This only makes sense if one uses the keywords postsmooth option and/or smooth fine.</td>
<td>10000</td>
</tr>
<tr>
<td>mg initialization</td>
<td><em>LOGICAL</em>: Sets the initial explicit residual smoothing with RK3 and local time stepping.</td>
<td>.FALSE.</td>
</tr>
<tr>
<td>initial residual</td>
<td><em>REAL</em>: Threshold for the <script type="math/tex">\|{\tilde{R}^{P}}\|_{\infty}</script> after which solver switches from the 'mg initialization' settings to user specified.</td>
<td>1.0</td>
</tr>
<tr>
<td>initial cfl</td>
<td><em>REAL</em>: CFL and DCFL number for initial residual smoothing.</td>
<td>0.1</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p>* The user must specify <em>mg sweeps pre</em> and <em>mg sweeps post</em>, or <em>mg sweeps</em></p>
    </div>
  </div>
      <hr>
    </div> <!-- /container -->
    <footer>
      <div class="container">
        <div class="row justify-content-between">
          <div class="col">
            <p>
              HORSES3D
 was developed by HORSES3D developers<br>              &copy; 2024 <a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc/4.0/80x15.png" /></a>
</p>
          </div>
          <div class="col">
            <p class="text-end">
              Documentation generated by
              <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
 on 2024-04-25 11:27              </p>
          </div>
        </div>
        <br>
      </div> <!-- /container -->
    </footer>

    <!-- Bootstrap core JavaScript -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>    

    <!-- MathJax JavaScript
             ================================================== -->
             <!-- Placed at the end of the document so the pages load faster -->
        <script type="text/x-mathjax-config">
          MathJax.Hub.Config({
          TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
          jax: ['input/TeX','input/MathML','output/HTML-CSS'],
          extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
          });
        </script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>


  </body>
</html>