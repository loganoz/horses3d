/* Control file for the implicit Navier-Stokes solver */
Flow equations        = "NSSA"
mesh file name        = "MESH/flatplateIBM.msh"

!--STL
stl file name = "flatplate2"

Polynomial order      = 2
Number of time steps  = 10000
Output Interval       = 10
autosave mode         = "iteration"
autosave interval     = 1000

mach number           = 0.2d0
Reynolds number       = 5000000.0d0
reference temperature (k) = 300.0d0

solution file name    = "RESULTS/IBM_FlatPlate.hsol"
save gradients with solution = .true.
restart               = .false.
restart file name     = "RESULTS/IBM_FlatPlate_0000002200.hsol"

inviscid discretization = standard
riemann solver         = "lax-friedrichs"
viscous discretization = "BR1"
simulation type       = steady-state

!----Solver
time integration = fas
convergence tolerance = 10.d-8

!--time step/CFL
cfl                   = 0.45d0
dcfl                  = 0.45d0

!--fas options
multigrid levels = 2
delta n = 1
mg sweeps exact = [2,1]
mg smoother = RKOpt
!mg preconditioner = LTS ! for all runge kutta explicit

wall function = standard

#define IBM
  name = FlatPlate
  active = .true.
  semi implicit = .true.
  describe = .true.
  number of objects = 3
  number of interpolation points = 6
  integration order = 3
  band region coefficient = 1.5
  plot mask = .true.
  target y plus = 30.0d0
#end

#define boundary inlet
  type = Inflow
#end

#define boundary outlet
  type = Outflow
#end

#define boundary walls
  type = FreeSlipWall
#end

#define boundary up
  type = Outflow
#end

#define boundary down
  type = FreeSlipWall
#end

!#define boundary body
!   type = FreeSlipWall
!#end 

#define boundary body
    type = NoSlipWall
#end

#define surface monitor 1
  Name = C_d
  Marker = flatplate2
  Variable = drag
  Direction = [1.d0, 0.d0, 0.d0]
  Reference surface =  0.2d0 
#end
