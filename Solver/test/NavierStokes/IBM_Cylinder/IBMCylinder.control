/* Control file for the implicit Navier-Stokes solver */
Flow equations        = "NS"
mesh file name        = "MESH/cylinder.mesh"

!--STL
stl file name         = "cylinder"

Polynomial order      = 3
Number of time steps  = 100
Output Interval       = 10 
autosave mode         = "iteration"
autosave interval     = 1000

mach number           = 0.2d0
Reynolds number       = 40.0d0

discretization nodes  = Gauss

solution file name    = "RESULTS/IBMCylinder.hsol"
save gradients with soluton = .false.
restart               = .true.
restart file name     = "RESULTS/IBMCylinder_0000003000.hsol"
riemann solver         = "lax-friedrichs"
viscous discretization = "IP"

!----Solver
time integration = fas
convergence tolerance = 8.d-8
!--time step/CFL
cfl                   = 0.25d0
dcfl                  = 0.25d0

multigrid levels        = 3
mg smoother             = RKOpt
mg preconditioner       = LTS
mg sweeps exact         = [1,1,1]

symmetry planes = [-3,3]

#define IBM
  name = Cylinder
  active = .true.
  semi implicit = .true.
  describe = .true.
  number of objects = 3
  number of interpolation points = 15
  integration order = 3
  band region coefficient = 3.5
  plot mask = .true.
#end

#define boundary BACK
  type = FreeSlipWall
#end

#define boundary FRONT
  type = FreeSlipWall
#end

#define boundary B1
  type = FreeSlipWall
#end

#define boundary B2
  type = OutFlow
#end

#define boundary B3
  type = FreeSlipWall
#end

#define boundary B4
  type = InFlow
#end


#define surface monitor 1
  Name = C_d
  Marker = cylinder
  Variable = drag
  Direction = [1.d0, 0.d0, 0.d0]
  Reference surface =  0.861d0 
#end
